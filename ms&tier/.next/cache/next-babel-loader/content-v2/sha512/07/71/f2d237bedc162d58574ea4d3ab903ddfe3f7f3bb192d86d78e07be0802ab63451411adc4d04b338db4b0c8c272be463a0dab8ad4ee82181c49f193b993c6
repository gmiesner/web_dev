{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/gmiesner/Documents/personal-code/web_dev/ms&tier/components/Search.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport axios from \"axios\";\nimport React from \"react\";\nimport Dropdown from \"./Dropdown\";\nimport SearchInput from \"./SearchInput\";\n\nvar Search = /*#__PURE__*/function (_React$Component) {\n  _inherits(Search, _React$Component);\n\n  var _super = _createSuper(Search);\n\n  function Search(props) {\n    var _this;\n\n    _classCallCheck(this, Search);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      menuHidden: true,\n      loading: false,\n      results: []\n    };\n    _this.search = _this.search.bind(_assertThisInitialized(_this));\n    _this.escapeMenu = _this.escapeMenu.bind(_assertThisInitialized(_this));\n    _this.selectCourse = _this.selectCourse.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Search, [{\n    key: \"search\",\n    value: function () {\n      var _search = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var query, url, response;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                query = event.target.value;\n\n                if (query) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 3:\n                // show loading message\n                this.setState({\n                  loading: true\n                }); // API call\n                // TODO: cache results?\n\n                url = \"/api/courses/?query=\".concat(encodeURIComponent(query));\n                _context.next = 7;\n                return axios.get(url)[\"catch\"](function () {\n                  alert(\"Unfortunately, an error occured :(\");\n                  return;\n                });\n\n              case 7:\n                response = _context.sent;\n                // update data, hide \"Loading...\", make results menu visible\n                this.setState({\n                  menuHidden: false,\n                  loading: false,\n                  results: response.data\n                });\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function search(_x) {\n        return _search.apply(this, arguments);\n      }\n\n      return search;\n    }() // hide menu with \"Esc\"\n    // TODO: hide menu when clicking outside the component\n\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.addEventListener(\"keydown\", this.escapeMenu, false);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener(\"keydown\", this.escapeMenu, false);\n    }\n  }, {\n    key: \"escapeMenu\",\n    value: function escapeMenu(event) {\n      if (event.keyCode === 27) {\n        this.setState({\n          menuHidden: true\n        });\n      }\n    }\n  }, {\n    key: \"selectCourse\",\n    value: function selectCourse(e) {\n      this.props.addClass(e.target.value);\n      this.setState({\n        menuHidden: true\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(SearchInput, {\n          onChange: this.search,\n          loading: this.state.loading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n          menuHidden: this.state.menuHidden,\n          selectCourse: this.selectCourse,\n          results: this.state.results\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return Search;\n}(React.Component);\n\nexport { Search as default };","map":{"version":3,"sources":["/Users/gmiesner/Documents/personal-code/web_dev/ms&tier/components/Search.js"],"names":["axios","React","Dropdown","SearchInput","Search","props","state","menuHidden","loading","results","search","bind","escapeMenu","selectCourse","event","query","target","value","setState","url","encodeURIComponent","get","alert","response","data","document","addEventListener","removeEventListener","keyCode","e","addClass","Component"],"mappings":";;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,WAAP,MAAwB,eAAxB;;IAEqBC,M;;;;;AACnB,kBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AAAEC,MAAAA,UAAU,EAAE,IAAd;AAAoBC,MAAAA,OAAO,EAAE,KAA7B;AAAoCC,MAAAA,OAAO,EAAE;AAA7C,KAAb;AACA,UAAKC,MAAL,GAAc,MAAKA,MAAL,CAAYC,IAAZ,+BAAd;AACA,UAAKC,UAAL,GAAkB,MAAKA,UAAL,CAAgBD,IAAhB,+BAAlB;AACA,UAAKE,YAAL,GAAoB,MAAKA,YAAL,CAAkBF,IAAlB,+BAApB;AALiB;AAMlB;;;;;8FAEYG,K;;;;;;AACLC,gBAAAA,K,GAAQD,KAAK,CAACE,MAAN,CAAaC,K;;oBACtBF,K;;;;;;;;AAIL;AACA,qBAAKG,QAAL,CAAc;AAAEV,kBAAAA,OAAO,EAAE;AAAX,iBAAd,E,CAEA;AACA;;AACMW,gBAAAA,G,iCAA6BC,kBAAkB,CAACL,KAAD,C;;uBAC9Bf,KAAK,CAACqB,GAAN,CAAUF,GAAV,WAAqB,YAAM;AAChDG,kBAAAA,KAAK,CAAC,oCAAD,CAAL;AACA;AACD,iBAHsB,C;;;AAAjBC,gBAAAA,Q;AAKN;AACA,qBAAKL,QAAL,CAAc;AACZX,kBAAAA,UAAU,EAAE,KADA;AAEZC,kBAAAA,OAAO,EAAE,KAFG;AAGZC,kBAAAA,OAAO,EAAEc,QAAQ,CAACC;AAHN,iBAAd;;;;;;;;;;;;;;;QAOF;AACA;;;;wCACoB;AAClBC,MAAAA,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,EAAqC,KAAKd,UAA1C,EAAsD,KAAtD;AACD;;;2CACsB;AACrBa,MAAAA,QAAQ,CAACE,mBAAT,CAA6B,SAA7B,EAAwC,KAAKf,UAA7C,EAAyD,KAAzD;AACD;;;+BACUE,K,EAAO;AAChB,UAAIA,KAAK,CAACc,OAAN,KAAkB,EAAtB,EAA0B;AACxB,aAAKV,QAAL,CAAc;AAAEX,UAAAA,UAAU,EAAE;AAAd,SAAd;AACD;AACF;;;iCAEYsB,C,EAAG;AACd,WAAKxB,KAAL,CAAWyB,QAAX,CAAoBD,CAAC,CAACb,MAAF,CAASC,KAA7B;AACA,WAAKC,QAAL,CAAc;AAAEX,QAAAA,UAAU,EAAE;AAAd,OAAd;AACD;;;6BAEQ;AACP,0BACE;AAAA,gCACE,QAAC,WAAD;AAAa,UAAA,QAAQ,EAAE,KAAKG,MAA5B;AAAoC,UAAA,OAAO,EAAE,KAAKJ,KAAL,CAAWE;AAAxD;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE,QAAC,QAAD;AACE,UAAA,UAAU,EAAE,KAAKF,KAAL,CAAWC,UADzB;AAEE,UAAA,YAAY,EAAE,KAAKM,YAFrB;AAGE,UAAA,OAAO,EAAE,KAAKP,KAAL,CAAWG;AAHtB;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cADF;AAUD;;;;EAhEiCR,KAAK,CAAC8B,S;;SAArB3B,M","sourcesContent":["import axios from \"axios\";\nimport React from \"react\";\nimport Dropdown from \"./Dropdown\";\nimport SearchInput from \"./SearchInput\";\n\nexport default class Search extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { menuHidden: true, loading: false, results: [] };\n    this.search = this.search.bind(this);\n    this.escapeMenu = this.escapeMenu.bind(this);\n    this.selectCourse = this.selectCourse.bind(this);\n  }\n\n  async search(event) {\n    const query = event.target.value;\n    if (!query) {\n      return;\n    }\n\n    // show loading message\n    this.setState({ loading: true });\n\n    // API call\n    // TODO: cache results?\n    const url = `/api/courses/?query=${encodeURIComponent(query)}`;\n    const response = await axios.get(url).catch(() => {\n      alert(\"Unfortunately, an error occured :(\");\n      return;\n    });\n\n    // update data, hide \"Loading...\", make results menu visible\n    this.setState({\n      menuHidden: false,\n      loading: false,\n      results: response.data,\n    });\n  }\n\n  // hide menu with \"Esc\"\n  // TODO: hide menu when clicking outside the component\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.escapeMenu, false);\n  }\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.escapeMenu, false);\n  }\n  escapeMenu(event) {\n    if (event.keyCode === 27) {\n      this.setState({ menuHidden: true });\n    }\n  }\n\n  selectCourse(e) {\n    this.props.addClass(e.target.value);\n    this.setState({ menuHidden: true });\n  }\n\n  render() {\n    return (\n      <div>\n        <SearchInput onChange={this.search} loading={this.state.loading} />\n        <Dropdown\n          menuHidden={this.state.menuHidden}\n          selectCourse={this.selectCourse}\n          results={this.state.results}\n        />\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}